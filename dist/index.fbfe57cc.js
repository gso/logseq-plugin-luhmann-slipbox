var e=globalThis,t={},r={},n=e.parcelRequire8624;async function i(e){let t=await logseq.Editor.getBlock(e,{includeChildren:!1});if(null===t)return;let r=t.content.trim(),n=r.match(/\[\[.+\]\]/);if(n){let e="",i=/\{\{embed.*\[\[.+\]\].*\}\}/;e=i.test(r)?r.replace(i,`${n[0]}`):r.replace(/\[\[.+\]\]/,`{{embed ${n[0]}}}`),await logseq.Editor.updateBlock(t.uuid,e)}}async function o(e){let t=await logseq.Editor.getBlock(e,{includeChildren:!1});if(null===t)return;let r=t.content.trim();if(r.match(/\[\[.+\]\]/)){let e=/\{\{embed.*\[\[.+\]\].*\}\}/,n=e.test(r)?"collapse":"expand",i=await logseq.Editor.getPageBlocksTree(t[":block/page"]);if("expand"===n)for(let t of i){let r=t.content.trim(),n=r.match(/\[\[.+\]\]/);if(n&&!e.test(r)){let e=r.replace(/\[\[.+\]\]/,`{{embed ${n[0]}}}`);await logseq.Editor.updateBlock(t.uuid,e)}}else if("collapse"===n)for(let t of i){let r=t.content.trim(),n=r.match(/\[\[.+\]\]/);if(n&&e.test(r)){let i=r.replace(e,`${n[0]}`);await logseq.Editor.updateBlock(t.uuid,i)}}}}null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in r){var n=r[e];delete r[e];var i={id:e,exports:{}};return t[e]=i,n.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},e.parcelRequire8624=n),(0,n.register)("cVm5l",function(t,r){/*! For license information please see lsplugin.user.js.LICENSE.txt */self,t.exports=(()=>{var n={227:(e,t,r)=>{let n;var i=r(155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))}),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e},t.useColors=function(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(n=!1,()=>{n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(447)(t);let{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,o,a=null;function s(...e){if(!s.enabled)return;let n=Number(new Date),i=n-(r||n);s.diff=i,s.prev=r,s.curr=n,r=n,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";o++;let i=t.formatters[n];if("function"==typeof i){let t=e[o];r=i.call(s,t),e.splice(o,1),o--}return r}),t.formatArgs.call(s,e),(s.log||t.log).apply(s,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=n,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function n(e,r){let n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];let n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.slice(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){let r,n;if("*"===e[e.length-1])return!0;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{t[r]=e[r]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},856:function(e){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,r)}function r(e,n,i){return(r=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,r,n){var i=[null];i.push.apply(i,r);var o=new(Function.bind.apply(e,i));return n&&t(o,n.prototype),o}:Reflect.construct).apply(null,arguments)}function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var o,a=Object.hasOwnProperty,s=Object.setPrototypeOf,l=Object.isFrozen,c=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,f=Object.freeze,d=Object.seal,p=Object.create,h="undefined"!=typeof Reflect&&Reflect,m=h.apply,g=h.construct;m||(m=function(e,t,r){return e.apply(t,r)}),f||(f=function(e){return e}),d||(d=function(e){return e}),g||(g=function(e,t){return r(e,n(t))});var v=E(Array.prototype.forEach),y=E(Array.prototype.pop),b=E(Array.prototype.push),_=E(String.prototype.toLowerCase),w=E(String.prototype.match),x=E(String.prototype.replace),C=E(String.prototype.indexOf),O=E(String.prototype.trim),S=E(RegExp.prototype.test),k=(o=TypeError,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return g(o,t)});function E(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return m(e,t,n)}}function A(e,t){s&&s(e,null);for(var r=t.length;r--;){var n=t[r];if("string"==typeof n){var i=_(n);i!==n&&(l(t)||(t[r]=i),n=i)}e[n]=!0}return e}function j(e){var t,r=p(null);for(t in e)m(a,e,[t])&&(r[t]=e[t]);return r}function T(e,t){for(;null!==e;){var r=u(e,t);if(r){if(r.get)return E(r.get);if("function"==typeof r.value)return E(r.value)}e=c(e)}return function(e){return console.warn("fallback value for",e),null}}var I=f(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),F=f(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=f(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=f(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),M=f(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),P=f(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),R=f(["#text"]),D=f(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),U=f(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$=f(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=f(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=d(/<%[\w\W]*|[\w\W]*%>/gm),B=d(/^data-[\-\w.\u00B7-\uFFFF]/),W=d(/^aria-[\-\w]+$/),G=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),J=d(/^(?:\w+script|data):/i),Z=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),V=d(/^html$/i),K=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,i=function(e){return t(e)};if(i.version="2.3.8",i.removed=[],!r||!r.document||9!==r.document.nodeType)return i.isSupported=!1,i;var o=r.document,a=r.document,s=r.DocumentFragment,l=r.HTMLTemplateElement,c=r.Node,u=r.Element,d=r.NodeFilter,p=r.NamedNodeMap,h=void 0===p?r.NamedNodeMap||r.MozNamedAttrMap:p,m=r.HTMLFormElement,g=r.DOMParser,E=r.trustedTypes,Y=u.prototype,Q=T(Y,"cloneNode"),X=T(Y,"nextSibling"),ee=T(Y,"childNodes"),et=T(Y,"parentNode");if("function"==typeof l){var er=a.createElement("template");er.content&&er.content.ownerDocument&&(a=er.content.ownerDocument)}var en=K(E,o),ei=en?en.createHTML(""):"",eo=a,ea=eo.implementation,es=eo.createNodeIterator,el=eo.createDocumentFragment,ec=eo.getElementsByTagName,eu=o.importNode,ef={};try{ef=j(a).documentMode?a.documentMode:{}}catch(e){}var ed={};i.isSupported="function"==typeof et&&ea&&void 0!==ea.createHTMLDocument&&9!==ef;var ep,eh,em=G,eg=null,ev=A({},[].concat(n(I),n(F),n(L),n(M),n(R))),ey=null,eb=A({},[].concat(n(D),n(U),n($),n(z))),e_=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ew=null,ex=null,eC=!0,eO=!0,eS=!1,ek=!1,eE=!1,eA=!1,ej=!1,eT=!1,eI=!1,eF=!1,eL=!0,eN=!0,eM=!1,eP={},eR=null,eD=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eU=null,e$=A({},["audio","video","img","source","image","track"]),ez=null,eH=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eq="http://www.w3.org/1998/Math/MathML",eB="http://www.w3.org/2000/svg",eW="http://www.w3.org/1999/xhtml",eG=eW,eJ=!1,eZ=["application/xhtml+xml","text/html"],eV=null,eK=a.createElement("form"),eY=function(e){return e instanceof RegExp||e instanceof Function},eQ=function(t){eV&&eV===t||(t&&"object"===e(t)||(t={}),eg="ALLOWED_TAGS"in(t=j(t))?A({},t.ALLOWED_TAGS):ev,ey="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR):eb,ez="ADD_URI_SAFE_ATTR"in t?A(j(eH),t.ADD_URI_SAFE_ATTR):eH,eU="ADD_DATA_URI_TAGS"in t?A(j(e$),t.ADD_DATA_URI_TAGS):e$,eR="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS):eD,ew="FORBID_TAGS"in t?A({},t.FORBID_TAGS):{},ex="FORBID_ATTR"in t?A({},t.FORBID_ATTR):{},eP="USE_PROFILES"in t&&t.USE_PROFILES,eC=!1!==t.ALLOW_ARIA_ATTR,eO=!1!==t.ALLOW_DATA_ATTR,eS=t.ALLOW_UNKNOWN_PROTOCOLS||!1,ek=t.SAFE_FOR_TEMPLATES||!1,eE=t.WHOLE_DOCUMENT||!1,eT=t.RETURN_DOM||!1,eI=t.RETURN_DOM_FRAGMENT||!1,eF=t.RETURN_TRUSTED_TYPE||!1,ej=t.FORCE_BODY||!1,eL=!1!==t.SANITIZE_DOM,eN=!1!==t.KEEP_CONTENT,eM=t.IN_PLACE||!1,em=t.ALLOWED_URI_REGEXP||em,eG=t.NAMESPACE||eW,t.CUSTOM_ELEMENT_HANDLING&&eY(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(e_.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&eY(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(e_.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(e_.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eh="application/xhtml+xml"===(ep=ep=-1===eZ.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?function(e){return e}:_,ek&&(eO=!1),eI&&(eT=!0),eP&&(eg=A({},n(R)),ey=[],!0===eP.html&&(A(eg,I),A(ey,D)),!0===eP.svg&&(A(eg,F),A(ey,U),A(ey,z)),!0===eP.svgFilters&&(A(eg,L),A(ey,U),A(ey,z)),!0===eP.mathMl&&(A(eg,M),A(ey,$),A(ey,z))),t.ADD_TAGS&&(eg===ev&&(eg=j(eg)),A(eg,t.ADD_TAGS)),t.ADD_ATTR&&(ey===eb&&(ey=j(ey)),A(ey,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&A(ez,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(eR===eD&&(eR=j(eR)),A(eR,t.FORBID_CONTENTS)),eN&&(eg["#text"]=!0),eE&&A(eg,["html","head","body"]),eg.table&&(A(eg,["tbody"]),delete ew.tbody),f&&f(t),eV=t)},eX=A({},["mi","mo","mn","ms","mtext"]),e0=A({},["foreignobject","desc","title","annotation-xml"]),e1=A({},["title","style","font","a","script"]),e3=A({},F);A(e3,L),A(e3,N);var e9=A({},M);A(e9,P);var e2=function(e){var t=et(e);t&&t.tagName||(t={namespaceURI:eW,tagName:"template"});var r=_(e.tagName),n=_(t.tagName);return e.namespaceURI===eB?t.namespaceURI===eW?"svg"===r:t.namespaceURI===eq?"svg"===r&&("annotation-xml"===n||eX[n]):!!e3[r]:e.namespaceURI===eq?t.namespaceURI===eW?"math"===r:t.namespaceURI===eB?"math"===r&&e0[n]:!!e9[r]:e.namespaceURI===eW&&!(t.namespaceURI===eB&&!e0[n])&&!(t.namespaceURI===eq&&!eX[n])&&!e9[r]&&(e1[r]||!e3[r])},e6=function(e){b(i.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ei}catch(t){e.remove()}}},e4=function(e,t){try{b(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){b(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ey[e]){if(eT||eI)try{e6(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},e5=function(e){if(ej)e="<remove></remove>"+e;else{var t,r,n=w(e,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===ep&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=en?en.createHTML(e):e;if(eG===eW)try{t=(new g).parseFromString(i,ep)}catch(e){}if(!t||!t.documentElement){t=ea.createDocument(eG,"template",null);try{t.documentElement.innerHTML=eJ?"":i}catch(e){}}var o=t.body||t.documentElement;return e&&r&&o.insertBefore(a.createTextNode(r),o.childNodes[0]||null),eG===eW?ec.call(t,eE?"html":"body")[0]:eE?t.documentElement:o},e8=function(e){return es.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},e7=function(t){return"object"===e(c)?t instanceof c:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},te=function(e,t,r){ed[e]&&v(ed[e],function(e){e.call(i,t,r,eV)})},tt=function(e){if(te("beforeSanitizeElements",e,null),e instanceof m&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||S(/[\u0080-\uFFFF]/,e.nodeName))return e6(e),!0;var t,r=eh(e.nodeName);if(te("uponSanitizeElement",e,{tagName:r,allowedTags:eg}),e.hasChildNodes()&&!e7(e.firstElementChild)&&(!e7(e.content)||!e7(e.content.firstElementChild))&&S(/<[/\w]/g,e.innerHTML)&&S(/<[/\w]/g,e.textContent)||"select"===r&&S(/<template/i,e.innerHTML))return e6(e),!0;if(!eg[r]||ew[r]){if(!ew[r]&&tn(r)&&(e_.tagNameCheck instanceof RegExp&&S(e_.tagNameCheck,r)||e_.tagNameCheck instanceof Function&&e_.tagNameCheck(r)))return!1;if(eN&&!eR[r]){var n=et(e)||e.parentNode,o=ee(e)||e.childNodes;if(o&&n)for(var a=o.length-1;a>=0;--a)n.insertBefore(Q(o[a],!0),X(e))}return e6(e),!0}return e instanceof u&&!e2(e)?(e6(e),!0):("noscript"===r||"noembed"===r)&&S(/<\/no(script|embed)/i,e.innerHTML)?(e6(e),!0):(ek&&3===e.nodeType&&(t=x(t=e.textContent,H," "),t=x(t,q," "),e.textContent!==t&&(b(i.removed,{element:e.cloneNode()}),e.textContent=t)),te("afterSanitizeElements",e,null),!1)},tr=function(e,t,r){if(eL&&("id"===t||"name"===t)&&(r in a||r in eK))return!1;if(eO&&!ex[t]&&S(B,t));else if(eC&&S(W,t));else if(!ey[t]||ex[t]){if(!(tn(e)&&(e_.tagNameCheck instanceof RegExp&&S(e_.tagNameCheck,e)||e_.tagNameCheck instanceof Function&&e_.tagNameCheck(e))&&(e_.attributeNameCheck instanceof RegExp&&S(e_.attributeNameCheck,t)||e_.attributeNameCheck instanceof Function&&e_.attributeNameCheck(t))||"is"===t&&e_.allowCustomizedBuiltInElements&&(e_.tagNameCheck instanceof RegExp&&S(e_.tagNameCheck,r)||e_.tagNameCheck instanceof Function&&e_.tagNameCheck(r))))return!1}else if(ez[t]);else if(S(em,x(r,Z,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==C(r,"data:")||!eU[e]){if(eS&&!S(J,x(r,Z,"")));else if(r)return!1}return!0},tn=function(e){return e.indexOf("-")>0},ti=function(e){te("beforeSanitizeAttributes",e,null);var t,r,n,o,a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ey};for(o=a.length;o--;){var l=t=a[o],c=l.name,u=l.namespaceURI;if(r="value"===c?t.value:O(t.value),n=eh(c),s.attrName=n,s.attrValue=r,s.keepAttr=!0,s.forceKeepAttr=void 0,te("uponSanitizeAttribute",e,s),r=s.attrValue,!s.forceKeepAttr&&(e4(c,e),s.keepAttr)){if(S(/\/>/i,r))e4(c,e);else if(ek&&(r=x(r,H," "),r=x(r,q," ")),tr(eh(e.nodeName),n,r))try{u?e.setAttributeNS(u,c,r):e.setAttribute(c,r),y(i.removed)}catch(e){}}}te("afterSanitizeAttributes",e,null)}},to=function e(t){var r,n=e8(t);for(te("beforeSanitizeShadowDOM",t,null);r=n.nextNode();)te("uponSanitizeShadowNode",r,null),tt(r)||(r.content instanceof s&&e(r.content),ti(r));te("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(t,n){if((eJ=!t)&&(t="<!-->"),"string"!=typeof t&&!e7(t)){if("function"!=typeof t.toString)throw k("toString is not a function");if("string"!=typeof(t=t.toString()))throw k("dirty is not a string, aborting")}if(!i.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(e7(t))return r.toStaticHTML(t.outerHTML)}return t}if(eA||eQ(n),i.removed=[],"string"==typeof t&&(eM=!1),eM){if(t.nodeName){var a,l,u,f,d,p=eh(t.nodeName);if(!eg[p]||ew[p])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof c)1===(l=(a=e5("<!---->")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?a=l:a.appendChild(l);else{if(!eT&&!ek&&!eE&&-1===t.indexOf("<"))return en&&eF?en.createHTML(t):t;if(!(a=e5(t)))return eT?null:eF?ei:""}a&&ej&&e6(a.firstChild);for(var h=e8(eM?t:a);u=h.nextNode();)3===u.nodeType&&u===f||tt(u)||(u.content instanceof s&&to(u.content),ti(u),f=u);if(f=null,eM)return t;if(eT){if(eI)for(d=el.call(a.ownerDocument);a.firstChild;)d.appendChild(a.firstChild);else d=a;return ey.shadowroot&&(d=eu.call(o,d,!0)),d}var m=eE?a.outerHTML:a.innerHTML;return eE&&eg["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&S(V,a.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+m),ek&&(m=x(m,H," "),m=x(m,q," ")),en&&eF?en.createHTML(m):m},i.setConfig=function(e){eQ(e),eA=!0},i.clearConfig=function(){eV=null,eA=!1},i.isValidAttribute=function(e,t,r){return eV||eQ({}),tr(eh(e),eh(t),r)},i.addHook=function(e,t){"function"==typeof t&&(ed[e]=ed[e]||[],b(ed[e],t))},i.removeHook=function(e){if(ed[e])return y(ed[e])},i.removeHooks=function(e){ed[e]&&(ed[e]=[])},i.removeAllHooks=function(){ed={}},i}()}()},729:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!=typeof n)throw TypeError("The listener must be a function");var s=new i(n,o||e,a),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var l,c,u=this._events[s],f=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,o),!0;case 6:return u.fn.call(u.context,t,n,i,o,a),!0}for(c=1,l=Array(f-1);c<f;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var d,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),f){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,n);break;case 4:u[c].fn.call(u[c].context,t,n,i);break;default:if(!l)for(d=1,l=Array(f-1);d<f;d++)l[d-1]=arguments[d];u[c].fn.apply(u[c].context,l)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var l=0,c=[],u=s.length;l<u;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&c.push(s[l]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},824:e=>{function t(e,t,r,n){return Math.round(e/r)+" "+n+(t>=1.5*r?"s":"")}e.exports=function(e,r){r=r||{};var n,i,o=typeof e;if("string"===o&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===o&&isFinite(e))return r.long?(n=Math.abs(e))>=864e5?t(e,n,864e5,"day"):n>=36e5?t(e,n,36e5,"hour"):n>=6e4?t(e,n,6e4,"minute"):n>=1e3?t(e,n,1e3,"second"):e+" ms":(i=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":i>=36e5?Math.round(e/36e5)+"h":i>=6e4?Math.round(e/6e4)+"m":i>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},520:(e,t,r)=>{var n=r(155),i="win32"===n.platform,o=r(539);function a(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];i&&"."!==i&&(".."===i?r.length&&".."!==r[r.length-1]?r.pop():t&&r.push(".."):r.push(i))}return r}function s(e){for(var t=e.length-1,r=0;r<=t&&!e[r];r++);for(var n=t;n>=0&&!e[n];n--);return 0===r&&n===t?e:r>n?[]:e.slice(r,n+1)}var l=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,c=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function f(e){var t=l.exec(e),r=(t[1]||"")+(t[2]||""),n=t[3]||"",i=c.exec(n);return[r,i[1],i[2],i[3]]}function d(e){var t=l.exec(e),r=t[1]||"",n=!!r&&":"!==r[1];return{device:r,isUnc:n,isAbsolute:n||!!t[2],tail:t[3]}}function p(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var e,t="",r="",i=!1,s=arguments.length-1;s>=-1;s--){if(s>=0?e=arguments[s]:t?(e=n.env["="+t])&&e.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(e=t+"\\"):e=n.cwd(),!o.isString(e))throw TypeError("Arguments to path.resolve must be strings");if(e){var l=d(e),c=l.device,u=l.isUnc,f=l.isAbsolute,h=l.tail;if((!c||!t||c.toLowerCase()===t.toLowerCase())&&(t||(t=c),i||(r=h+"\\"+r,i=f),t&&i))break}}return u&&(t=p(t)),t+(i?"\\":"")+(r=a(r.split(/[\\\/]+/),!i).join("\\"))||"."},u.normalize=function(e){var t=d(e),r=t.device,n=t.isUnc,i=t.isAbsolute,o=t.tail,s=/[\\\/]$/.test(o);return(o=a(o.split(/[\\\/]+/),!i).join("\\"))||i||(o="."),o&&s&&(o+="\\"),n&&(r=p(r)),r+(i?"\\":"")+o},u.isAbsolute=function(e){return d(e).isAbsolute},u.join=function(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(!o.isString(r))throw TypeError("Arguments to path.join must be strings");r&&e.push(r)}var n=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(n=n.replace(/^[\\\/]{2,}/,"\\")),u.normalize(n)},u.relative=function(e,t){e=u.resolve(e),t=u.resolve(t);for(var r=e.toLowerCase(),n=t.toLowerCase(),i=s(t.split("\\")),o=s(r.split("\\")),a=s(n.split("\\")),l=Math.min(o.length,a.length),c=l,f=0;f<l;f++)if(o[f]!==a[f]){c=f;break}if(0==c)return t;var d=[];for(f=c;f<o.length;f++)d.push("..");return(d=d.concat(i.slice(c))).join("\\")},u._makeLong=function(e){if(!o.isString(e))return e;if(!e)return"";var t=u.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},u.dirname=function(e){var t=f(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},u.basename=function(e,t){var r=f(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},u.extname=function(e){return f(e)[3]},u.format=function(e){if(!o.isObject(e))throw TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var r=e.dir,n=e.base||"";return r?r[r.length-1]===u.sep?r+n:r+u.sep+n:n},u.parse=function(e){if(!o.isString(e))throw TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=f(e);if(!t||4!==t.length)throw TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},u.sep="\\",u.delimiter=";";var h=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,m={};function g(e){return h.exec(e).slice(1)}m.resolve=function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var i=r>=0?arguments[r]:n.cwd();if(!o.isString(i))throw TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t="/"===i[0])}return(t?"/":"")+(e=a(e.split("/"),!t).join("/"))||"."},m.normalize=function(e){var t=m.isAbsolute(e),r=e&&"/"===e[e.length-1];return(e=a(e.split("/"),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},m.isAbsolute=function(e){return"/"===e.charAt(0)},m.join=function(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];if(!o.isString(r))throw TypeError("Arguments to path.join must be strings");r&&(e+=e?"/"+r:r)}return m.normalize(e)},m.relative=function(e,t){e=m.resolve(e).substr(1),t=m.resolve(t).substr(1);for(var r=s(e.split("/")),n=s(t.split("/")),i=Math.min(r.length,n.length),o=i,a=0;a<i;a++)if(r[a]!==n[a]){o=a;break}var l=[];for(a=o;a<r.length;a++)l.push("..");return(l=l.concat(n.slice(o))).join("/")},m._makeLong=function(e){return e},m.dirname=function(e){var t=g(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},m.basename=function(e,t){var r=g(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},m.extname=function(e){return g(e)[3]},m.format=function(e){if(!o.isObject(e))throw TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+m.sep:"")+(e.base||"")},m.parse=function(e){if(!o.isString(e))throw TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=g(e);if(!t||4!==t.length)throw TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},m.sep="/",m.delimiter=":",e.exports=i?u:m,e.exports.posix=m,e.exports.win32=u},155:e=>{var t,r,n=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,l=[],c=!1,u=-1;function f(){c&&s&&(c=!1,s.length?l=s.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=a(f);c=!0;for(var t=l.length;t;){for(s=l,l=[];++u<t;)s&&s[u].run();u=-1,t=l.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=h,n.addListener=h,n.once=h,n.off=h,n.removeListener=h,n.removeAllListeners=h,n.emit=h,n.prependListener=h,n.prependOnceListener=h,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},539:(e,t,r)=>{var n=r(155),i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),l=n[r];r<o;l=n[++r])m(l)||!_(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(e,i){if(y(r.g.process))return function(){return t.deprecate(e,i).apply(this,arguments)};if(!0===n.noDeprecation)return e;var o=!1;return function(){if(!o){if(n.throwDeprecation)throw Error(i);n.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,a={};function s(e,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(r)?n.showHidden=r:r&&t._extend(n,r),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),u(n,e,n.depth)}function l(e,t){var r=s.styles[t];return r?"\x1b["+s.colors[r][0]+"m"+e+"\x1b["+s.colors[r][1]+"m":e}function c(e,t){return e}function u(e,r,n){if(e.customInspect&&r&&C(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i,o,a=r.inspect(n,e);return v(a)||(a=u(e,a,n)),a}var s=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return g(t)?e.stylize(""+t,"number"):h(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,r);if(s)return s;var l=Object.keys(r),c=(O={},l.forEach(function(e,t){O[e]=!0}),O);if(e.showHidden&&(l=Object.getOwnPropertyNames(r)),x(r)&&(l.indexOf("message")>=0||l.indexOf("description")>=0))return f(r);if(0===l.length){if(C(r)){var _=r.name?": "+r.name:"";return e.stylize("[Function"+_+"]","special")}if(b(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(x(r))return f(r)}var O,S,k="",A=!1,j=["{","}"];return p(r)&&(A=!0,j=["[","]"]),C(r)&&(k=" [Function"+(r.name?": "+r.name:"")+"]"),b(r)&&(k=" "+RegExp.prototype.toString.call(r)),w(r)&&(k=" "+Date.prototype.toUTCString.call(r)),x(r)&&(k=" "+f(r)),0!==l.length||A&&0!=r.length?n<0?b(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),S=A?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)E(t,String(a))?o.push(d(e,t,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(d(e,t,r,n,i,!0))}),o}(e,r,n,c,l):l.map(function(t){return d(e,r,n,c,t,A)}),e.seen.pop(),i=k,o=j,S.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?o[0]+(""===i?"":i+"\n ")+" "+S.join(",\n  ")+" "+o[1]:o[0]+i+" "+S.join(", ")+" "+o[1]):j[0]+k+j[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),E(n,i)||(a="["+i+"]"),s||(0>e.seen.indexOf(l.value)?(s=m(r)?u(e,l.value,null):u(e,l.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return _(e)&&"[object RegExp]"===O(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===O(e)}function x(e){return _(e)&&("[object Error]"===O(e)||e instanceof Error)}function C(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(y(o)&&(o=n.env.NODE_DEBUG||""),!a[e=e.toUpperCase()]){if(RegExp("\\b"+e+"\\b","i").test(o)){var r=n.pid;a[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else a[e]=function(){}}return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=h,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=_,t.isDate=w,t.isError=x,t.isFunction=C,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(384);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,r;console.log("%s - %s",(r=[S((e=new Date).getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":"),[e.getDate(),k[e.getMonth()],r].join(" ")),t.format.apply(t,arguments))},t.inherits=r(717),t._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}},i={};function o(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={exports:{}};return n[e].call(r.exports,r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{o.r(a),o.d(a,{LSPluginUser:()=>ne,setupPluginUserInstance:()=>nt});var n,i,s,l,c,u,f,d=o(520);o(856);let p=function(e,t){return e===t||e!=e&&t!=t},h=function(e,t){for(var r=e.length;r--;)if(p(e[r][0],t))return r;return -1};var m=Array.prototype.splice;function g(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}g.prototype.clear=function(){this.__data__=[],this.size=0},g.prototype.delete=function(e){var t=this.__data__,r=h(t,e);return!(r<0)&&(r==t.length-1?t.pop():m.call(t,r,1),--this.size,!0)},g.prototype.get=function(e){var t=this.__data__,r=h(t,e);return r<0?void 0:t[r][1]},g.prototype.has=function(e){return h(this.__data__,e)>-1},g.prototype.set=function(e,t){var r=this.__data__,n=h(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};let v="object"==typeof e&&e&&e.Object===Object&&e;var y="object"==typeof self&&self&&self.Object===Object&&self;let b=v||y||Function("return this")(),_=b.Symbol;var w=Object.prototype,x=w.hasOwnProperty,C=w.toString,O=_?_.toStringTag:void 0;let S=function(e){var t=x.call(e,O),r=e[O];try{e[O]=void 0;var n=!0}catch(e){}var i=C.call(e);return n&&(t?e[O]=r:delete e[O]),i};var k=Object.prototype.toString,E=_?_.toStringTag:void 0;let A=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":E&&E in Object(e)?S(e):k.call(e)},j=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},T=function(e){if(!j(e))return!1;var t=A(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},I=b["__core-js_shared__"];var F,L=(F=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+F:"",N=Function.prototype.toString;let M=function(e){if(null!=e){try{return N.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var P=/^\[object .+?Constructor\]$/,R=Object.prototype,D=Function.prototype.toString,U=R.hasOwnProperty,$=RegExp("^"+D.call(U).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let z=function(e,t){var r=null==e?void 0:e[t];return!(!j(r)||L&&L in r)&&(T(r)?$:P).test(M(r))?r:void 0},H=z(b,"Map"),q=z(Object,"create");var B=Object.prototype.hasOwnProperty,W=Object.prototype.hasOwnProperty;function G(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}G.prototype.clear=function(){this.__data__=q?q(null):{},this.size=0},G.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},G.prototype.get=function(e){var t=this.__data__;if(q){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return B.call(t,e)?t[e]:void 0},G.prototype.has=function(e){var t=this.__data__;return q?void 0!==t[e]:W.call(t,e)},G.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=q&&void 0===t?"__lodash_hash_undefined__":t,this};let J=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},Z=function(e,t){var r=e.__data__;return J(t)?r["string"==typeof t?"string":"hash"]:r.map};function V(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function K(e){var t=this.__data__=new g(e);this.size=t.size}V.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(H||g),string:new G}},V.prototype.delete=function(e){var t=Z(this,e).delete(e);return this.size-=t?1:0,t},V.prototype.get=function(e){return Z(this,e).get(e)},V.prototype.has=function(e){return Z(this,e).has(e)},V.prototype.set=function(e,t){var r=Z(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},K.prototype.clear=function(){this.__data__=new g,this.size=0},K.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},K.prototype.get=function(e){return this.__data__.get(e)},K.prototype.has=function(e){return this.__data__.has(e)},K.prototype.set=function(e,t){var r=this.__data__;if(r instanceof g){var n=r.__data__;if(!H||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new V(n)}return r.set(e,t),this.size=r.size,this};let Y=function(){try{var e=z(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Q=function(e,t,r){"__proto__"==t&&Y?Y(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},X=function(e,t,r){(void 0===r||p(e[t],r))&&(void 0!==r||t in e)||Q(e,t,r)},ee=function(e,t,r){for(var n=-1,i=Object(e),o=r(e),a=o.length;a--;){var s=o[++n];if(!1===t(i[s],s,i))break}return e};var et=r&&!r.nodeType&&r,er=et&&t&&!t.nodeType&&t,en=er&&er.exports===et?b.Buffer:void 0,ei=en?en.allocUnsafe:void 0;let eo=function(e,t){if(t)return e.slice();var r=e.length,n=ei?ei(r):new e.constructor(r);return e.copy(n),n},ea=b.Uint8Array,es=function(e){var t=new e.constructor(e.byteLength);return new ea(t).set(new ea(e)),t},el=function(e,t){var r=t?es(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},ec=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var eu=Object.create;let ef=function(){function e(){}return function(t){if(!j(t))return{};if(eu)return eu(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),ed=function(e,t){return function(r){return e(t(r))}},ep=ed(Object.getPrototypeOf,Object);var eh=Object.prototype;let em=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||eh)},eg=function(e){return null!=e&&"object"==typeof e},ev=function(e){return eg(e)&&"[object Arguments]"==A(e)};var ey=Object.prototype,eb=ey.hasOwnProperty,e_=ey.propertyIsEnumerable;let ew=ev(function(){return arguments}())?ev:function(e){return eg(e)&&eb.call(e,"callee")&&!e_.call(e,"callee")},ex=Array.isArray,eC=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},eO=function(e){return null!=e&&eC(e.length)&&!T(e)};var eS=r&&!r.nodeType&&r,ek=eS&&t&&!t.nodeType&&t,eE=ek&&ek.exports===eS?b.Buffer:void 0;let eA=(eE?eE.isBuffer:void 0)||function(){return!1};var ej=Object.prototype,eT=Function.prototype.toString,eI=ej.hasOwnProperty,eF=eT.call(Object);let eL=function(e){if(!eg(e)||"[object Object]"!=A(e))return!1;var t=ep(e);if(null===t)return!0;var r=eI.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&eT.call(r)==eF};var eN={};eN["[object Float32Array]"]=eN["[object Float64Array]"]=eN["[object Int8Array]"]=eN["[object Int16Array]"]=eN["[object Int32Array]"]=eN["[object Uint8Array]"]=eN["[object Uint8ClampedArray]"]=eN["[object Uint16Array]"]=eN["[object Uint32Array]"]=!0,eN["[object Arguments]"]=eN["[object Array]"]=eN["[object ArrayBuffer]"]=eN["[object Boolean]"]=eN["[object DataView]"]=eN["[object Date]"]=eN["[object Error]"]=eN["[object Function]"]=eN["[object Map]"]=eN["[object Number]"]=eN["[object Object]"]=eN["[object RegExp]"]=eN["[object Set]"]=eN["[object String]"]=eN["[object WeakMap]"]=!1;var eM=r&&!r.nodeType&&r,eP=eM&&t&&!t.nodeType&&t,eR=eP&&eP.exports===eM&&v.process,eD=function(){try{return eP&&eP.require&&eP.require("util").types||eR&&eR.binding&&eR.binding("util")}catch(e){}}(),eU=eD&&eD.isTypedArray;let e$=eU?function(e){return eU(e)}:function(e){return eg(e)&&eC(e.length)&&!!eN[A(e)]},ez=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var eH=Object.prototype.hasOwnProperty;let eq=function(e,t,r){var n=e[t];eH.call(e,t)&&p(n,r)&&(void 0!==r||t in e)||Q(e,t,r)},eB=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,a=t.length;++o<a;){var s=t[o],l=n?n(r[s],e[s],s,r,e):void 0;void 0===l&&(l=e[s]),i?Q(r,s,l):eq(r,s,l)}return r},eW=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var eG=/^(?:0|[1-9]\d*)$/;let eJ=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&eG.test(e))&&e>-1&&e%1==0&&e<t};var eZ=Object.prototype.hasOwnProperty;let eV=function(e,t){var r=ex(e),n=!r&&ew(e),i=!r&&!n&&eA(e),o=!r&&!n&&!i&&e$(e),a=r||n||i||o,s=a?eW(e.length,String):[],l=s.length;for(var c in e)!t&&!eZ.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||eJ(c,l))||s.push(c);return s},eK=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t};var eY=Object.prototype.hasOwnProperty;let eQ=function(e){if(!j(e))return eK(e);var t=em(e),r=[];for(var n in e)("constructor"!=n||!t&&eY.call(e,n))&&r.push(n);return r},eX=function(e){return eO(e)?eV(e,!0):eQ(e)},e0=function(e,t,r,n,i,o,a){var s=ez(e,r),l=ez(t,r),c=a.get(l);if(c)X(e,r,c);else{var u=o?o(s,l,r+"",e,t,a):void 0,f=void 0===u;if(f){var d=ex(l),p=!d&&eA(l),h=!d&&!p&&e$(l);u=l,d||p||h?ex(s)?u=s:eg(s)&&eO(s)?u=ec(s):p?(f=!1,u=eo(l,!0)):h?(f=!1,u=el(l,!0)):u=[]:eL(l)||ew(l)?(u=s,ew(s)?u=eB(s,eX(s)):j(s)&&!T(s)||(u="function"!=typeof l.constructor||em(l)?{}:ef(ep(l)))):f=!1}f&&(a.set(l,u),i(u,l,n,o,a),a.delete(l)),X(e,r,u)}},e1=function e(t,r,n,i,o){t!==r&&ee(r,function(a,s){if(o||(o=new K),j(a))e0(t,r,s,n,e,i,o);else{var l=i?i(ez(t,s),a,s+"",t,r,o):void 0;void 0===l&&(l=a),X(t,s,l)}},eX)},e3=function(e){return e},e9=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)};var e2=Math.max;let e6=Y?function(e,t){return Y(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:e3;var e4=Date.now;let e5=(s=0,l=0,function(){var e=e4(),t=16-(e-l);if(l=e,t>0){if(++s>=800)return arguments[0]}else s=0;return e6.apply(void 0,arguments)}),e8=function(e,t,r){if(!j(r))return!1;var n=typeof t;return!!("number"==n?eO(r)&&eJ(t,r.length):"string"==n&&t in r)&&p(r[t],e)},e7=(c=function(e,t,r){e1(e,t,r)},e5((i=e2((i=void 0,(n=function(e,t){var r=-1,n=t.length,i=n>1?t[n-1]:void 0,o=n>2?t[2]:void 0;for(i=c.length>3&&"function"==typeof i?(n--,i):void 0,o&&e8(t[0],t[1],o)&&(i=n<3?void 0:i,n=1),e=Object(e);++r<n;){var a=t[r];a&&c(e,a,r,i)}return e}).length-1),0),function(){for(var e=arguments,t=-1,r=e2(e.length-i,0),o=Array(r);++t<r;)o[t]=e[i+t];t=-1;for(var a=Array(i+1);++t<i;)a[t]=e[t];return a[i]=e3(o),e9(n,this,a)}),n+""));var te=function(){return(te=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function tt(e){return e.toLowerCase()}var tr=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],tn=/[^A-Z0-9]+/gi;function ti(e,t,r){return t instanceof RegExp?e.replace(t,r):t.reduce(function(e,t){return e.replace(t,r)},e)}var to=o(729),ta=o.n(to);function ts(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let tl="win32"===navigator.platform.toLowerCase()?d.win32:d.posix,tc=function(e,t){var r;return void 0===t&&(t={}),void 0===(r=te({delimiter:"_"},t))&&(r={}),function(e,t){void 0===t&&(t={});for(var r=t.splitRegexp,n=t.stripRegexp,i=t.transform,o=void 0===i?tt:i,a=t.delimiter,s=void 0===a?" ":a,l=ti(ti(e,void 0===r?tr:r,"$1\x00$2"),void 0===n?tn:n,"\x00"),c=0,u=l.length;"\x00"===l.charAt(c);)c++;for(;"\x00"===l.charAt(u-1);)u--;return l.slice(c,u).split("\x00").map(o).join(s)}(e,te({delimiter:"."},r))};class tu extends ta(){constructor(e,t){super(),ts(this,"_tag",void 0),ts(this,"_opts",void 0),ts(this,"_logs",[]),this._tag=e,this._opts=t}write(e,t,r){var n,i;null!=t&&t.length&&!0===t[t.length-1]&&(r=!0,t.pop());let o=t.reduce((e,t)=>(t&&t instanceof Error?e+=`${t.message} ${t.stack}`:e+=t.toString(),e),`[${this._tag}][${(new Date).toLocaleTimeString()}] `);this._logs.push([e,o]),(r||null!==(n=this._opts)&&void 0!==n&&n.console)&&(null===(i=console)||void 0===i||i["ERROR"===e?"error":"debug"](`${e}: ${o}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function tf(e,t){let r,n,i=!1,o=t=>r=>{e&&clearTimeout(e),t(r),i=!0},a=new Promise((i,a)=>{r=o(i),n=o(a),e&&(e=setTimeout(()=>n(Error(`[deferred timeout] ${t}`)),e))});return{created:Date.now(),setTag:e=>t=e,resolve:r,reject:n,promise:a,get settled(){return i}}}let td=new Map;window.__injectedUIEffects=td;var tp=o(227),th=o.n(tp);function tm(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let tg="application/x-postmate-v1+json",tv=0,ty={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},tb=(e,t)=>("string"!=typeof t||e.origin===t)&&!!e.data&&("object"!=typeof e.data||"postmate"in e.data)&&e.data.type===tg&&!!ty[e.data.postmate];class t_{constructor(e){tm(this,"parent",void 0),tm(this,"frame",void 0),tm(this,"child",void 0),tm(this,"events",{}),tm(this,"childOrigin",void 0),tm(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=e=>{if(!tb(e,this.childOrigin))return!1;let{data:t,name:r}=((e||{}).data||{}).value||{};"emit"===e.data.postmate&&r in this.events&&this.events[r].forEach(e=>{e.call(this,t)})},this.parent.addEventListener("message",this.listener,!1)}get(e,...t){return new Promise(r=>{let n=++tv,i=e=>{e.data.uid===n&&"reply"===e.data.postmate&&(this.parent.removeEventListener("message",i,!1),r(e.data.value))};this.parent.addEventListener("message",i,!1),this.child.postMessage({postmate:"request",type:tg,property:e,args:t,uid:n},this.childOrigin)})}call(e,t){this.child.postMessage({postmate:"call",type:tg,property:e,data:t},this.childOrigin)}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class tw{constructor(e){tm(this,"model",void 0),tm(this,"parent",void 0),tm(this,"parentOrigin",void 0),tm(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",e=>{if(!tb(e,this.parentOrigin))return;let{property:t,uid:r,data:n,args:i}=e.data;"call"!==e.data.postmate?((e,t,r)=>{let n="function"==typeof e[t]?e[t].apply(null,r):e[t];return Promise.resolve(n)})(this.model,t,i).then(n=>{e.source.postMessage({property:t,postmate:"reply",type:tg,uid:r,value:n},e.origin)}):t in this.model&&"function"==typeof this.model[t]&&this.model[t](n)})}emit(e,t){this.parent.postMessage({postmate:"emit",type:tg,value:{name:e,data:t}},this.parentOrigin)}}class tx{constructor(e){tm(this,"container",void 0),tm(this,"parent",void 0),tm(this,"frame",void 0),tm(this,"child",void 0),tm(this,"childOrigin",void 0),tm(this,"url",void 0),tm(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){let t=(e=>{let t=document.createElement("a");t.href=e;let r=t.protocol.length>4?t.protocol:window.location.protocol,n=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||`${r}//${n}`})(e=e||this.url),r,n=0;return new Promise((i,o)=>{let a=e=>!!tb(e,t)&&("handshake-reply"===e.data.postmate?(clearInterval(r),this.parent.removeEventListener("message",a,!1),this.childOrigin=e.origin,i(new t_(this))):o("Failed handshake"));this.parent.addEventListener("message",a,!1);let s=()=>{n++,this.child.postMessage({postmate:"handshake",type:tg,model:this.model},t),5===n&&clearInterval(r)};this.frame.addEventListener("load",()=>{s(),r=setInterval(s,500)}),this.frame.src=e})}destroy(){this.frame.parentNode.removeChild(this.frame)}}tm(tx,"debug",!1),tm(tx,"Model",void 0);class tC{constructor(e){tm(this,"child",void 0),tm(this,"model",void 0),tm(this,"parent",void 0),tm(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((e,t)=>{let r=n=>{if(n.data.postmate){if("handshake"===n.data.postmate){this.child.removeEventListener("message",r,!1),n.source.postMessage({postmate:"handshake-reply",type:tg},n.origin),this.parentOrigin=n.origin;let t=n.data.model;return t&&Object.keys(t).forEach(e=>{this.model[e]=t[e]}),e(new tw(this))}return t("Handshake Reply Failed")}};this.child.addEventListener("message",r,!1)})}}function tO(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let{importHTML:tS,createSandboxContainer:tk}=window.QSandbox||{};function tE(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise(async(t,r)=>{try{let r=await window.apis.doAction(["readFile",e]);t({text:()=>r})}catch(e){console.error(e),r(e)}}))}class tA extends ta(){constructor(e){super(),tO(this,"_pluginLocal",void 0),tO(this,"_frame",void 0),tO(this,"_root",void 0),tO(this,"_loaded",!1),tO(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose(()=>{this._unmount()})}async load(){let{name:e,entry:t}=this._pluginLocal.options;if(this.loaded||!t)return;let{template:r,execScripts:n}=await tS(t,{fetch:tE});this._mount(r,document.body);let i=tk(e,{elementGetter:()=>{var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}}).instance.proxy;i.__shadow_mode__=!0,i.LSPluginLocal=this._pluginLocal,i.LSPluginShadow=this,i.LSPluginUser=i.logseq=new ne(this._pluginLocal.toJSON(),this._pluginLocal.caller);let o=await n(i,!0);this._unmountFns.push(o.unmount),this._loaded=!0}_mount(e,t){let r=this._frame=document.createElement("div");r.classList.add("lsp-shadow-sandbox"),r.id=this._pluginLocal.id,this._root=r.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,t.appendChild(r),this.emit("mounted")}_unmount(){for(let e of this._unmountFns)e&&e.call(null)}destroy(){var e,t;null===(e=this.frame)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}get frame(){return this._frame}}function tj(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let tT=th()("LSPlugin:caller"),tI="#await#response#",tF="#lspmsg#error#",tL=e=>`#lspmsg#${e}`;class tN extends ta(){constructor(e){super(),tj(this,"_pluginLocal",void 0),tj(this,"_connected",!1),tj(this,"_parent",void 0),tj(this,"_child",void 0),tj(this,"_shadow",void 0),tj(this,"_status",void 0),tj(this,"_userModel",{}),tj(this,"_call",void 0),tj(this,"_callUserModel",void 0),tj(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;let{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){var t;if(this._connected)return;let r=this,n=null!=this._pluginLocal,i=0,o=new Map,a=tf(6e4),s=this._extendUserModel({"#lspmsg#ready#":async e=>{s[tL(null==e?void 0:e.pid)]=({type:e,payload:t})=>{tT(`[host (_call) -> *user] ${this._debugTag}`,e,t),r.emit(e,t)},await a.resolve()},"#lspmsg#beforeunload#":async e=>{let t=tf(1e4);r.emit("beforeunload",Object.assign({actor:t},e)),await t.promise},"#lspmsg#settings#":async({type:e,payload:t})=>{r.emit("settings:changed",t)},"#lspmsg#":async({ns:e,type:t,payload:n})=>{tT(`[host (async) -> *user] ${this._debugTag} ns=${e} type=${t}`,n),e&&e.startsWith("hook")?r.emit(`${e}:${t}`,n):r.emit(t,n)},"#lspmsg#reply#":({_sync:e,result:t})=>{if(tT(`[sync host -> *user] #${e}`,t),o.has(e)){let r=o.get(e);r&&(null!=t&&t.hasOwnProperty(tF)?r.reject(t[tF]):r.resolve(t),o.delete(e))}},...e});if(n)return await a.promise,JSON.parse(JSON.stringify(null===(t=this._pluginLocal)||void 0===t?void 0:t.toJSON()));let l=new tC(s).sendHandshakeReply();return this._status="pending",await l.then(e=>{this._child=e,this._connected=!0,this._call=async(t,r={},n)=>{if(n){let e=++i;o.set(e,n),r._sync=e,n.setTag(`async call #${e}`),tT(`async call #${e}`)}return e.emit(tL(s.baseInfo.id),{type:t,payload:r}),null==n?void 0:n.promise},this._callUserModel=async(e,t)=>{try{s[e](t)}catch(t){tT(`[model method] #${e} not existed`)}},setInterval(()=>{if(o.size>100)for(let[e,t]of o)t.settled&&o.delete(e)},18e5)}).finally(()=>{this._status=void 0}),await a.promise,s.baseInfo}async call(e,t={}){var r;return null===(r=this._call)||void 0===r?void 0:r.call(this,e,t)}async callAsync(e,t={}){var r;let n=tf(1e4);return null===(r=this._call)||void 0===r?void 0:r.call(this,e,t,n)}async callUserModel(e,...t){var r;return null===(r=this._callUserModel)||void 0===r?void 0:r.apply(this,[e,...t])}async callUserModelAsync(e,...t){var r;return e=`${tI}${e}`,null===(r=this._callUserModel)||void 0===r?void 0:r.apply(this,[e,...t])}async _setupIframeSandbox(){let e=this._pluginLocal,t=e.id,r=`${t}_lsp_main`,n=new URL(e.options.entry);n.searchParams.set("__v__",e.options.version);let i=document.querySelector(`#${r}`);i&&i.parentElement.removeChild(i);let o=document.createElement("div");o.classList.add("lsp-iframe-sandbox-container"),o.id=r,o.dataset.pid=t;try{var a;let e=null===(a=await this._pluginLocal._loadLayoutsData())||void 0===a?void 0:a.$$0;if(e){o.dataset.inited_layout="true";let{width:t,height:r,left:n,top:i,vw:a,vh:s}=e;n=Math.max(n,0),n="number"==typeof a?`${Math.min(100*n/a,99)}%`:`${n}px`,i=Math.max(i,45),i="number"==typeof s?`${Math.min(100*i/s,99)}%`:`${i}px`,Object.assign(o.style,{width:t+"px",height:r+"px",left:n,top:i})}}catch(e){console.error("[Restore Layout Error]",e)}document.body.appendChild(o);let s=new tx({id:t+"_iframe",container:o,url:n.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}}),l,c=s.sendHandshake();return this._status="pending",new Promise((t,r)=>{l=setTimeout(()=>{r(Error("handshake Timeout")),s.destroy()},4e3),c.then(r=>{this._parent=r,this._connected=!0,this.emit("connected"),r.on(tL(e.id),({type:e,payload:t})=>{var r,n;tT("[user -> *host] ",e,t),null===(r=this._pluginLocal)||void 0===r||r.emit(e,t||{}),null===(n=this._pluginLocal)||void 0===n||n.caller.emit(e,t||{})}),this._call=async(...t)=>{await r.call(tL(e.id),{type:t[0],payload:Object.assign(t[1]||{},{$$pid:e.id})})},this._callUserModel=async(e,...t)=>{if(e.startsWith(tI))return await r.get(e.replace(tI,""),...t);r.call(e,null==t?void 0:t[0])},t(null)}).catch(e=>{r(e)}).finally(()=>{clearTimeout(l)})}).catch(e=>{throw tT("[iframe sandbox] error",e),e}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){let e=this._pluginLocal,t=this._shadow=new tA(e);try{this._status="pending",await t.load(),this._connected=!0,this.emit("connected"),this._call=async(t,r={},n)=>{var i;return n&&(r.actor=n),null===(i=this._pluginLocal)||void 0===i||i.emit(t,Object.assign(r,{$$pid:e.id})),null==n?void 0:n.promise},this._callUserModel=async(...e)=>{var t;let r=e[0];null!==(t=r)&&void 0!==t&&t.startsWith(tI)&&(r=r.replace(tI,""));let n=e[1]||{},i=this._userModel[r];"function"==typeof i&&await i.call(null,n)}}catch(e){throw tT("[shadow sandbox] error",e),e}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame}_getSandboxShadowRoot(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let t=null;this._parent&&(t=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(t=this._getSandboxShadowContainer(),this._shadow.destroy()),null===(e=t)||void 0===e||e.parentNode.removeChild(t)}}function tM(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class tP{constructor(e,t){tM(this,"ctx",void 0),tM(this,"opts",void 0),this.ctx=e,this.opts=t}get ctxId(){return this.ctx.baseInfo.id}setItem(e,t){var r;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,t,null===(r=this.opts)||void 0===r?void 0:r.assets]})}getItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}removeItem(e){var t;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}hasItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}}class tR{constructor(e){var t;t=void 0,"ctx"in this?Object.defineProperty(this,"ctx",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.ctx=t,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...t){var r,n;let i=this.ensureHostScope();return e=null===(r=tc(e))||void 0===r?void 0:r.toLowerCase(),null===(n=i.logseq.api["exper_"+e])||void 0===n?void 0:n.apply(i,t)}async loadScripts(...e){(e=e.map(e=>null!=e&&e.startsWith("http")?e:this.ctx.resolveResourceFullUrl(e))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,t){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,t)}registerExtensionsEnhancer(e,t){let r=this.ensureHostScope();return"katex"===e&&r.katex&&t(r.katex).catch(console.error),r.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,t)}ensureHostScope(){if(window===top)throw Error("Can not access host scope!");return top}}function tD(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let tU=e=>`task_callback_${e}`;class t${constructor(e,t,r={}){tD(this,"_client",void 0),tD(this,"_requestId",void 0),tD(this,"_requestOptions",void 0),tD(this,"_promise",void 0),tD(this,"_aborted",!1),this._client=e,this._requestId=t,this._requestOptions=r,this._promise=new Promise((e,t)=>{if(!this._requestId)return t(null);this._client.once(tU(this._requestId),r=>{r&&r instanceof Error?t(r):e(r)})});let{success:n,fail:i,final:o}=this._requestOptions;this._promise.then(e=>{null==n||n(e)}).catch(e=>{null==i||i(e)}).finally(()=>{null==o||o()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class tz extends to.EventEmitter{constructor(e){super(),tD(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",e=>{let t=null==e?void 0:e.requestId;t&&this.emit(tU(t),null==e?void 0:e.payload)})}static createRequestTask(e,t,r){return new t$(e,t,r)}async _request(e){let t=this.ctx.baseInfo.id,{success:r,fail:n,final:i,...o}=e,a=this.ctx.Experiments.invokeExperMethod("request",t,o),s=tz.createRequestTask(this.ctx.Request,a,e);return o.abortable?s:s.promise}get ctx(){return this._ctx}}let tH=ed(Object.keys,Object);var tq=Object.prototype.hasOwnProperty;let tB=function(e){if(!em(e))return tH(e);var t=[];for(var r in Object(e))tq.call(e,r)&&"constructor"!=r&&t.push(r);return t},tW=function(e){return eO(e)?eV(e):tB(e)};function tG(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new V;++t<r;)this.add(e[t])}tG.prototype.add=tG.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},tG.prototype.has=function(e){return this.__data__.has(e)};let tJ=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},tZ=function(e,t,r,n,i,o){var a=1&r,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var f=-1,d=!0,p=2&r?new tG:void 0;for(o.set(e,t),o.set(t,e);++f<s;){var h=e[f],m=t[f];if(n)var g=a?n(m,h,f,t,e,o):n(h,m,f,e,t,o);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!tJ(t,function(e,t){if(!p.has(t)&&(h===e||i(h,e,r,n,o)))return p.push(t)})){d=!1;break}}else if(h!==m&&!i(h,m,r,n,o)){d=!1;break}}return o.delete(e),o.delete(t),d},tV=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r},tK=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r};var tY=_?_.prototype:void 0,tQ=tY?tY.valueOf:void 0;let tX=function(e,t,r,n,i,o,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new ea(e),new ea(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return p(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=tV;case"[object Set]":var l=1&n;if(s||(s=tK),e.size!=t.size&&!l)break;var c=a.get(e);if(c)return c==t;n|=2,a.set(e,t);var u=tZ(s(e),s(t),n,i,o,a);return a.delete(e),u;case"[object Symbol]":if(tQ)return tQ.call(e)==tQ.call(t)}return!1},t0=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e},t1=function(e,t,r){var n=t(e);return ex(e)?n:t0(n,r(e))},t3=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var a=e[r];t(a,r,e)&&(o[i++]=a)}return o};var t9=Object.prototype.propertyIsEnumerable,t2=Object.getOwnPropertySymbols;let t6=t2?function(e){return null==e?[]:t3(t2(e=Object(e)),function(t){return t9.call(e,t)})}:function(){return[]},t4=function(e){return t1(e,tW,t6)};var t5=Object.prototype.hasOwnProperty;let t8=function(e,t,r,n,i,o){var a=1&r,s=t4(e),l=s.length;if(l!=t4(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:t5.call(t,u)))return!1}var f=o.get(e),d=o.get(t);if(f&&d)return f==t&&d==e;var p=!0;o.set(e,t),o.set(t,e);for(var h=a;++c<l;){var m=e[u=s[c]],g=t[u];if(n)var v=a?n(g,m,u,t,e,o):n(m,g,u,e,t,o);if(!(void 0===v?m===g||i(m,g,r,n,o):v)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return o.delete(e),o.delete(t),p},t7=z(b,"DataView"),re=z(b,"Promise"),rt=z(b,"Set"),rr=z(b,"WeakMap");var rn="[object Map]",ri="[object Promise]",ro="[object Set]",ra="[object WeakMap]",rs="[object DataView]",rl=M(t7),rc=M(H),ru=M(re),rf=M(rt),rd=M(rr),rp=A;(t7&&rp(new t7(new ArrayBuffer(1)))!=rs||H&&rp(new H)!=rn||re&&rp(re.resolve())!=ri||rt&&rp(new rt)!=ro||rr&&rp(new rr)!=ra)&&(rp=function(e){var t=A(e),r="[object Object]"==t?e.constructor:void 0,n=r?M(r):"";if(n)switch(n){case rl:return rs;case rc:return rn;case ru:return ri;case rf:return ro;case rd:return ra}return t});let rh=rp;var rm="[object Arguments]",rg="[object Array]",rv="[object Object]",ry=Object.prototype.hasOwnProperty;let rb=function(e,t,r,n,i,o){var a=ex(e),s=ex(t),l=a?rg:rh(e),c=s?rg:rh(t),u=(l=l==rm?rv:l)==rv,f=(c=c==rm?rv:c)==rv,d=l==c;if(d&&eA(e)){if(!eA(t))return!1;a=!0,u=!1}if(d&&!u)return o||(o=new K),a||e$(e)?tZ(e,t,r,n,i,o):tX(e,t,l,r,n,i,o);if(!(1&r)){var p=u&&ry.call(e,"__wrapped__"),h=f&&ry.call(t,"__wrapped__");if(p||h){var m=p?e.value():e,g=h?t.value():t;return o||(o=new K),i(m,g,r,n,o)}}return!!d&&(o||(o=new K),t8(e,t,r,n,i,o))},r_=function e(t,r,n,i,o){return t===r||(null!=t&&null!=r&&(eg(t)||eg(r))?rb(t,r,n,i,e,o):t!=t&&r!=r)},rw=function(e,t,r,n){var i=r.length,o=i,a=!n;if(null==e)return!o;for(e=Object(e);i--;){var s=r[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=r[i])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var f=new K;if(n)var d=n(c,u,l,e,t,f);if(!(void 0===d?r_(u,c,3,n,f):d))return!1}}return!0},rx=function(e){return e==e&&!j(e)},rC=function(e){for(var t=tW(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,rx(i)]}return t},rO=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},rS=function(e){var t=rC(e);return 1==t.length&&t[0][2]?rO(t[0][0],t[0][1]):function(r){return r===e||rw(r,e,t)}},rk=function(e){return"symbol"==typeof e||eg(e)&&"[object Symbol]"==A(e)};var rE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rA=/^\w*$/;let rj=function(e,t){if(ex(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!rk(e))||rA.test(e)||!rE.test(e)||null!=t&&e in Object(t)};function rT(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(rT.Cache||V),r}rT.Cache=V;var rI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rF=/\\(\\)?/g;let rL=(f=(u=rT(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rI,function(e,r,n,i){t.push(n?i.replace(rF,"$1"):r||e)}),t},function(e){return 500===f.size&&f.clear(),e})).cache,u),rN=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i};var rM=_?_.prototype:void 0,rP=rM?rM.toString:void 0;let rR=function e(t){if("string"==typeof t)return t;if(ex(t))return rN(t,e)+"";if(rk(t))return rP?rP.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r},rD=function(e,t){return ex(e)?e:rj(e,t)?[e]:rL(null==e?"":rR(e))},rU=function(e){if("string"==typeof e||rk(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},r$=function(e,t){for(var r=0,n=(t=rD(t,e)).length;null!=e&&r<n;)e=e[rU(t[r++])];return r&&r==n?e:void 0},rz=function(e,t,r){var n=null==e?void 0:r$(e,t);return void 0===n?r:n},rH=function(e,t){return null!=e&&t in Object(e)},rq=function(e,t,r){for(var n=-1,i=(t=rD(t,e)).length,o=!1;++n<i;){var a=rU(t[n]);if(!(o=null!=e&&r(e,a)))break;e=e[a]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&eC(i)&&eJ(a,i)&&(ex(e)||ew(e))},rB=function(e){var t;return rj(e)?(t=rU(e),function(e){return null==e?void 0:e[t]}):function(t){return r$(t,e)}},rW=function(e){var t,r;return"function"==typeof e?e:null==e?e3:"object"==typeof e?ex(e)?(t=e[0],r=e[1],rj(t)&&rx(r)?rO(rU(t),r):function(e){var n=rz(e,t);return void 0===n&&n===r?null!=e&&rq(e,t,rH):r_(r,n,3)}):rS(e):rB(e)},rG=function(e,t){var r={};return t=rW(t,3),e&&ee(e,function(e,n,i){Q(r,t(e,n,i),e)},tW),r};function rJ(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class rZ{constructor(e,t){rJ(this,"ctx",void 0),rJ(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=t,e._execCallableAPI("register-search-service",e.baseInfo.id,t.name,t.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:e=>(ex(null==e?void 0:e.blocks)&&(e.blocks=e.blocks.map(e=>e&&rG(e,(e,t)=>`block/${t}`))),e)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([r,n])=>{let i=`service:search:${r}:${t.name}`;e.caller.on(i,async r=>{if(T(null==t?void 0:t[n.f])){let o=null;try{o=await t[n.f].apply(t,(n.args||[]).map(e=>{if(r){if(!0===e)return r;if(r.hasOwnProperty(e)){let t=r[e];return delete r[e],t}}})),n.transformOutput&&(o=n.transformOutput(o))}catch(e){console.error("[SearchService] ",e),o=e}finally{n.reply&&e.caller.call(`${i}:reply`,o)}}})})}}function rV(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let rK=Symbol.for("proxy-continue"),rY=th()("LSPlugin:user"),rQ=new tu("",{console:!0});function rX(e,t,r){var n;if("function"!=typeof r)return!1;let{key:i,label:o,desc:a,palette:s,keybinding:l,extras:c}=t,u=`SimpleCommandHook${i}${++r2}`;this.Editor["on"+u](r),null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:i,label:o,type:e,desc:a,keybinding:l,extras:c},["editor/hook",u]],s]})}function r0(e){return!("string"!=typeof e||36!==e.length||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e))||(rQ.error(`#${e} is not a valid UUID string.`),!1)}let r1=null,r3=new Map,r9={async getInfo(e){return r1||(r1=await this._execCallableAPIAsync("get-app-info")),"string"==typeof e?r1[e]:r1},registerCommand:rX,registerSearchService(e){if(r3.has(e.name))throw Error(`SearchService: #${e.name} has registered!`);r3.set(e.name,new rZ(this,e))},registerCommandPalette(e,t){let{key:r,label:n,keybinding:i}=e;return rX.call(this,"$palette$",{key:r,label:n,palette:!0,keybinding:i},t)},registerCommandShortcut(e,t){let{binding:r}=e,n="$shortcut$",i=n+tc(r);return rX.call(this,n,{key:i,palette:!1,keybinding:e},t)},registerUIItem(e,t){var r;let n=this.baseInfo.id;null===(r=this.caller)||void 0===r||r.call("api:call",{method:"register-plugin-ui-item",args:[n,e,t]})},registerPageMenuItem(e,t){if("function"!=typeof t)return!1;let r=e+"_"+this.baseInfo.id;rX.call(this,"page-menu-item",{key:r,label:e},t)},onBlockRendererSlotted(e,t){if(!r0(e))return;let r=this.baseInfo.id,n=`hook:editor:${tc(`slot:${e}`)}`;return this.caller.on(n,t),this.App._installPluginHook(r,n),()=>{this.caller.off(n,t),this.App._uninstallPluginHook(r,n)}},invokeExternalPlugin(e,...t){var r;if(!(e=null===(r=e)||void 0===r?void 0:r.trim()))return;let[n,i]=e.split(".");if(!["models","commands"].includes(null==i?void 0:i.toLowerCase()))throw Error("Type only support '.models' or '.commands' currently.");let o=e.replace(`${n}.${i}.`,"");if(!n||!i||!o)throw Error(`Illegal type of #${e} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",n,i.toLowerCase(),o,t)},setFullScreen(e){let t=(...e)=>this._callWin("setFullScreen",...e);"toggle"===e?this._callWin("isFullScreen").then(e=>{e?t():t(!0)}):e?t(!0):t()}},r2=0,r6={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(e,t){var r;rY("Register slash command #",this.baseInfo.id,e,t),"function"==typeof t&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map(e=>{let[t,...r]=e;if("editor/hook"===t){let n=r[0],i=()=>{var e;null===(e=this.caller)||void 0===e||e.callUserModel(n)};"function"==typeof n&&(i=n);let o=`SlashCommandHook${t}${++r2}`;e[1]=o,this.Editor["on"+o](i)}return e}),null===(r=this.caller)||void 0===r||r.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if("function"!=typeof t)return!1;let r=e+"_"+this.baseInfo.id;rX.call(this,"block-context-menu-item",{key:r,label:e},t)},registerHighlightContextMenuItem(e,t,r){if("function"!=typeof t)return!1;let n=e+"_"+this.baseInfo.id;rX.call(this,"highlight-context-menu-item",{key:n,label:e,extras:r},t)},scrollToBlockInPage(e,t,r){let n="block-content-"+t;null!=r&&r.replaceState?this.App.replaceState("page",{name:e},{anchor:n}):this.App.pushState("page",{name:e},{anchor:n})}},r4={onBlockChanged(e,t){if(!r0(e))return;let r=this.baseInfo.id,n=`hook:db:${tc(`block:${e}`)}`,i=({block:r,txData:n,txMeta:i})=>{r.uuid===e&&t(r,n,i)};return this.caller.on(n,i),this.App._installPluginHook(r,n),()=>{this.caller.off(n,i),this.App._uninstallPluginHook(r,n)}},datascriptQuery(e,...t){return(t.pop(),null!=t&&t.some(e=>"function"==typeof e))?this.Experiments.ensureHostScope().logseq.api.datascript_query(e,...t):this._execCallableAPIAsync("datascript_query",e,...t)}},r5={},r8={},r7={makeSandboxStorage(){return new tP(this,{assets:!0})}};class ne extends ta(){constructor(e,t){super(),rV(this,"_baseInfo",void 0),rV(this,"_caller",void 0),rV(this,"_version","0.0.15"),rV(this,"_debugTag",""),rV(this,"_settingsSchema",void 0),rV(this,"_connected",!1),rV(this,"_ui",new Map),rV(this,"_mFileStorage",void 0),rV(this,"_mRequest",void 0),rV(this,"_mExperiments",void 0),rV(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=t,t.on("sys:ui:visible",e=>{null!=e&&e.toggle&&this.toggleMainUI()}),t.on("settings:changed",e=>{let t=Object.assign({},this.settings),r=Object.assign(this._baseInfo.settings,e);this.emit("settings:changed",{...r},t)}),t.on("beforeunload",async e=>{let{actor:r,...n}=e,i=this._beforeunloadCallback;try{i&&await i(n),null==r||r.resolve(null)}catch(e){console.debug(`${t.debugTag} [beforeunload] `,e),null==r||r.reject(e)}})}async ready(e,t){if(!this._connected)try{var r;"function"==typeof e&&(t=e,e={});let n=await this._caller.connectToParent(e);this._connected=!0,n=e7(this._baseInfo,n),null!==(r=n)&&void 0!==r&&r.id&&(this._debugTag=this._caller.debugTag=`#${n.id} [${n.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(n.settings=function(e,t){let r=(t||[]).reduce((e,t)=>("default"in t&&(e[t.key]=t.default),e),{});return Object.assign(r,e)}(n.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(e){console.warn(e)}t&&t.call(this,n)}catch(e){console.error(`${this._debugTag} [Ready Error]`,e)}}ensureConnected(){if(!this._connected)throw Error("not connected")}beforeunload(e){"function"==typeof e&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){let t="settings:changed";return this.on(t,e),()=>this.off(t,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){let t={key:0,visible:!1,cursor:null==e?void 0:e.restoreEditingCursor};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}showMainUI(e){let t={key:0,visible:!0,autoFocus:null==e?void 0:e.autoFocus};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}toggleMainUI(){let e=this._ui.get(0);e&&e.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){let e=this._ui.get(0);return!!(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){var e,t;return this&&((null===(e=this.baseInfo)||void 0===e?void 0:e.effect)||!(null!==(t=this.baseInfo)&&void 0!==t&&t.iir))}get logger(){return rQ}get settings(){var e;return null===(e=this.baseInfo)||void 0===e?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),function(e,...t){try{let r=new URL(e);if(!r.origin)throw Error(null);let n=tl.join(e.substr(r.origin.length),...t);return r.origin+n}catch(r){return tl.join(e,...t)}}(this._baseInfo.lsr,e)}_makeUserProxy(e,t){let r=this,n=this.caller;return new Proxy(e,{get(e,i,o){let a=e[i];return function(...e){if(a){let n=a.apply(r,e.concat(t));if(n!==rK)return n}if(t){let o=i.toString().match(/^(once|off|on)/i);if(null!=o){let i=o[0].toLowerCase(),a=o.input.slice(i.length),s=r.baseInfo.id,l=`hook:${t}:${tc(a)}`,c=e[0],u=e[1];n[i](l,c);let f=()=>{n.off(l,c),n.listenerCount(l)||r.App._uninstallPluginHook(s,l)};return"off"===i?void f():(r.App._installPluginHook(s,l,u),f)}}let o=i;return["git","ui","assets"].includes(t)&&(o=t+"_"+o),n.callAsync("api:call",{tag:t,method:o,args:e})}}})}_execCallableAPIAsync(e,...t){return this._caller.callAsync("api:call",{method:e,args:t})}_execCallableAPI(e,...t){this._caller.call("api:call",{method:e,args:t})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(r9,"app")}get Editor(){return this._makeUserProxy(r6,"editor")}get DB(){return this._makeUserProxy(r4,"db")}get Git(){return this._makeUserProxy(r5,"git")}get UI(){return this._makeUserProxy(r8,"ui")}get Assets(){return this._makeUserProxy(r7,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new tP(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new tz(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new tR(this)),e}}function nt(e,t){return new ne(e,t)}if(null==window.__LSP__HOST__){let e=new tN(null);window.logseq=nt({},e)}})(),a})()}),n("cVm5l"),logseq.ready(()=>{logseq.Editor.registerSlashCommand("ZK Toggle Block",async e=>{i(e.uuid)}),logseq.Editor.registerBlockContextMenuItem("ZK Toggle Block",async e=>{i(e.uuid)}),logseq.Editor.registerSlashCommand("ZK Toggle Sequence",async e=>{o(e.uuid)}),logseq.Editor.registerBlockContextMenuItem("ZK Toggle Sequence",async e=>{o(e.uuid)})}).catch(console.error);